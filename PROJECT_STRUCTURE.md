# RecallPin é¡¹ç›®ç»“æ„è¯´æ˜

## é¡¹ç›®æ¦‚è¿°

RecallPin æ˜¯ä¸€ä¸ªæ™ºèƒ½ä¹¦ç­¾æ‰©å±•ï¼Œèåˆ Recallï¼ˆå¿«é€Ÿæ£€ç´¢ï¼‰ä¸ Pinï¼ˆé’‰ä½ï¼‰ç†å¿µï¼Œæä¾›æ™ºèƒ½åˆ†ç±»ã€å…³é”®è¯æå–ã€å¿«é€Ÿæœç´¢ç­‰åŠŸèƒ½ã€‚é¡¹ç›®é‡‡ç”¨ç°ä»£å‰ç«¯æŠ€æœ¯æ ˆï¼Œæ”¯æŒ Chrome æ‰©å±• APIã€‚

## æŠ€æœ¯æ ˆ

- **å‰ç«¯æ¡†æ¶**: React 18 + TypeScript
- **UI ç»„ä»¶åº“**: Ant Design + Tailwind CSS
- **çŠ¶æ€ç®¡ç†**: Zustand
- **æ•°æ®å­˜å‚¨**: IndexedDB + Dexie.js
- **æ„å»ºå·¥å…·**: Vite + CRXJS
- **å…³é”®è¯æå–**: nodejieba + è‡ªå®šä¹‰åˆ†è¯ç®—æ³•
- **æ‹–æ‹½åŠŸèƒ½**: @dnd-kit
- **æœç´¢åŠŸèƒ½**: Fuse.js

## é¡¹ç›®ç»“æ„æ ‘

```
smartBrowserBookmarks/
â”œâ”€â”€ ğŸ“ assets/                          # é™æ€èµ„æºç›®å½•
â”œâ”€â”€ ğŸ“ dist/                            # æ„å»ºè¾“å‡ºç›®å½•
â”‚   â”œâ”€â”€ ğŸ“ assets/                      # æ„å»ºåçš„é™æ€èµ„æº
â”‚   â”œâ”€â”€ ğŸ“„ manifest.json               # æ„å»ºåçš„æ’ä»¶æ¸…å•
â”‚   â””â”€â”€ ğŸ“ src/                         # æ„å»ºåçš„é¡µé¢æ–‡ä»¶
â”‚       â”œâ”€â”€ ğŸ“ main/                   # ä¸»ç•Œé¢é¡µé¢
â”‚       â”œâ”€â”€ ğŸ“ options/                # è®¾ç½®é¡µé¢
â”‚       â””â”€â”€ ğŸ“ popup/                  # å¼¹çª—é¡µé¢
â”œâ”€â”€ ğŸ“ node_modules/                    # ä¾èµ–åŒ…ç›®å½•
â”œâ”€â”€ ğŸ“ src/                            # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ ğŸ“ background/                 # åå°æœåŠ¡è„šæœ¬
â”‚   â”‚   â””â”€â”€ ğŸ“„ index.ts               # åå°æœåŠ¡ä¸»æ–‡ä»¶
â”‚   â”œâ”€â”€ ğŸ“ content/                    # å†…å®¹è„šæœ¬
â”‚   â”‚   â””â”€â”€ ğŸ“„ index.ts               # å†…å®¹è„šæœ¬ä¸»æ–‡ä»¶
â”‚   â”œâ”€â”€ ğŸ“ main/                       # ä¸»ç•Œé¢
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ index.html             # ä¸»ç•Œé¢HTMLæ¨¡æ¿
â”‚   â”‚   â””â”€â”€ ğŸ“„ index.tsx              # ä¸»ç•Œé¢Reactç»„ä»¶
â”‚   â”œâ”€â”€ ğŸ“ options/                    # è®¾ç½®é¡µé¢
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ index.html             # è®¾ç½®é¡µé¢HTMLæ¨¡æ¿
â”‚   â”‚   â””â”€â”€ ğŸ“„ index.tsx              # è®¾ç½®é¡µé¢Reactç»„ä»¶
â”‚   â”œâ”€â”€ ğŸ“ popup/                      # å¼¹çª—ç•Œé¢
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ App.tsx                # å¼¹çª—ä¸»ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ index.css              # å¼¹çª—æ ·å¼æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ index.html             # å¼¹çª—HTMLæ¨¡æ¿
â”‚   â”‚   â””â”€â”€ ğŸ“„ index.tsx              # å¼¹çª—å…¥å£æ–‡ä»¶
â”‚   â””â”€â”€ ğŸ“ shared/                     # å…±äº«æ¨¡å—
â”‚       â”œâ”€â”€ ğŸ“ storage/                # æ•°æ®å­˜å‚¨ç›¸å…³
â”‚       â”‚   â””â”€â”€ ğŸ“„ database.ts        # IndexedDBæ•°æ®åº“é…ç½®
â”‚       â””â”€â”€ ğŸ“ types/                  # ç±»å‹å®šä¹‰
â”‚           â””â”€â”€ ğŸ“„ index.ts           # TypeScriptç±»å‹å®šä¹‰
â”œâ”€â”€ ğŸ“„ manifest.json                   # Chromeæ‰©å±•æ¸…å•æ–‡ä»¶
â”œâ”€â”€ ğŸ“„ package.json                    # é¡¹ç›®ä¾èµ–å’Œè„šæœ¬é…ç½®
â”œâ”€â”€ ğŸ“„ package-lock.json              # ä¾èµ–é”å®šæ–‡ä»¶
â”œâ”€â”€ ğŸ“„ postcss.config.js              # PostCSSé…ç½®
â”œâ”€â”€ ğŸ“„ README.md                       # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ ğŸ“„ tailwind.config.js             # Tailwind CSSé…ç½®
â”œâ”€â”€ ğŸ“„ tsconfig.json                   # TypeScripté…ç½®
â”œâ”€â”€ ğŸ“„ tsconfig.node.json              # Node.js TypeScripté…ç½®
â””â”€â”€ ğŸ“„ vite.config.ts                  # Viteæ„å»ºé…ç½®
```

## æ ¸å¿ƒæ–‡ä»¶è¯¦è§£

### ğŸ”§ é…ç½®æ–‡ä»¶

#### `manifest.json` - Chrome æ‰©å±•æ¸…å•ï¼ˆç²¾ç®€æƒé™ï¼‰

```json
{
  "manifest_version": 3,
  "name": "RecallPin",
  "permissions": ["storage", "bookmarks", "activeTab", "scripting"],
  "background": {
    "service_worker": "src/background/index.ts"
  },
  "action": {
    "default_popup": "src/popup/index.html"
  },
  "options_page": "src/options/index.html"
}
```

#### `vite.config.ts` - æ„å»ºé…ç½®

- ä½¿ç”¨ `@crxjs/vite-plugin` æ’ä»¶æ”¯æŒ Chrome æ‰©å±•å¼€å‘
- é…ç½®å¤šå…¥å£æ„å»ºï¼ˆpopupã€optionsã€mainï¼‰
- è®¾ç½®è·¯å¾„åˆ«å `@` æŒ‡å‘ `src` ç›®å½•

#### `tsconfig.json` - TypeScript é…ç½®

- ç›®æ ‡ç‰ˆæœ¬ï¼šES2020
- å¯ç”¨ä¸¥æ ¼æ¨¡å¼
- æ”¯æŒ Chrome æ‰©å±•ç±»å‹å®šä¹‰
- é…ç½®è·¯å¾„æ˜ å°„

### ğŸ¯ æ ¸å¿ƒåŠŸèƒ½æ¨¡å—

#### `src/background/index.ts` - åå°æœåŠ¡è„šæœ¬

**ä½œç”¨**: Chrome æ‰©å±•çš„åå°æœåŠ¡ï¼Œå¤„ç†è·¨ç»„ä»¶é€šä¿¡å’Œæµè§ˆå™¨ API è°ƒç”¨

**ä¸»è¦åŠŸèƒ½**:

- ğŸ“¡ æ¶ˆæ¯è·¯ç”±ï¼šå¤„ç†æ¥è‡ª popup çš„æ¶ˆæ¯
- ğŸ” ä¹¦ç­¾ç®¡ç†ï¼šè·å–ã€æ·»åŠ ã€ç§»åŠ¨ Chrome ä¹¦ç­¾
- ğŸŒ é¡µé¢ä¿¡æ¯è·å–ï¼šæŒ‰éœ€æ³¨å…¥å†…å®¹è„šæœ¬è·å–å½“å‰é¡µé¢ä¿¡æ¯ï¼ˆactiveTab + scriptingï¼‰
- âš¡ åŸºç¡€å…³é”®è¯ç”Ÿæˆï¼šå½“å†…å®¹è„šæœ¬ä¸å¯ç”¨æ—¶çš„å¤‡ç”¨æ–¹æ¡ˆ

**å…³é”®æ–¹æ³•**:

```typescript
// è·å–å½“å‰é¡µé¢ä¿¡æ¯
case "getCurrentPageInfo":
  // ä¸content scripté€šä¿¡è·å–é¡µé¢å…³é”®è¯å’Œå†…å®¹

// æ·»åŠ ä¹¦ç­¾
case "addBookmark":
  // å°†å…³é”®è¯æ·»åŠ åˆ°ä¹¦ç­¾æ ‡é¢˜ä¸­

// è·å–ä¹¦ç­¾æ ‘
case "getBookmarks":
  // è¿”å›Chromeä¹¦ç­¾çš„å®Œæ•´æ ‘ç»“æ„
```

#### `src/content/index.ts` - å†…å®¹è„šæœ¬

**ä½œç”¨**: åœ¨ç½‘é¡µä¸­æ³¨å…¥çš„è„šæœ¬ï¼Œè´Ÿè´£é¡µé¢å†…å®¹åˆ†æå’Œå…³é”®è¯æå–

**æ ¸å¿ƒç±»**: `PageAnalyzer`

**ä¸»è¦åŠŸèƒ½**:

- ğŸ” **é¡µé¢å†…å®¹æå–**: è·å–é¡µé¢æ­£æ–‡ï¼ˆå»é™¤è„šæœ¬ã€æ ·å¼ç­‰ï¼‰
- ğŸ·ï¸ **å…³é”®è¯æå–**: ä½¿ç”¨ nodejieba åˆ†è¯ + å¤‡ç”¨ç®—æ³•
- ğŸ“ **Meta ä¿¡æ¯è·å–**: æå– descriptionã€keywords ç­‰ meta æ ‡ç­¾
- ğŸ¯ **æ™ºèƒ½åˆ†è¯**: æ”¯æŒä¸­è‹±æ–‡æ··åˆåˆ†è¯
- ğŸš« **åœç”¨è¯è¿‡æ»¤**: è¿‡æ»¤å¸¸è§æ— æ„ä¹‰è¯æ±‡

**å…³é”®è¯æå–ç­–ç•¥**:

```typescript
// 1. ä¼˜å…ˆä½¿ç”¨nodejiebaæœç´¢å¼•æ“æ¨¡å¼åˆ†è¯ + å…³é”®è¯æå–
if (nodejiebaå¯ç”¨) {
  const searchWords = nodejieba.cutForSearch(text); // æœç´¢å¼•æ“æ¨¡å¼åˆ†è¯
  const extractedWords = nodejieba.extract(text, 8); // å…³é”®è¯æå–ç®—æ³•
  const allWords = [...searchWords, ...extractedWords]; // åˆå¹¶ç»“æœ
  // ç»Ÿè®¡è¯é¢‘ï¼Œè¿‡æ»¤åœç”¨è¯ï¼Œè¿”å›å‰6ä¸ªé«˜é¢‘æ ¸å¿ƒè¯
}

// 2. å¤‡ç”¨æ–¹æ¡ˆï¼šæ­£åˆ™è¡¨è¾¾å¼åˆ†è¯
const chineseWords = text.match(/[\u4e00-\u9fa5]{2,}/g);
const englishWords = text.match(/[a-zA-Z]{3,}/g);

// 3. è¯é¢‘ç»Ÿè®¡å’Œåœç”¨è¯è¿‡æ»¤
// 4. æŒ‰é¢‘ç‡æ’åºè¿”å›å‰6ä¸ªé«˜é¢‘æ ¸å¿ƒè¯
```

#### `src/shared/types/index.ts` - ç±»å‹å®šä¹‰

**ä½œç”¨**: å®šä¹‰æ•´ä¸ªé¡¹ç›®çš„æ•°æ®ç»“æ„å’Œæ¥å£

**æ ¸å¿ƒæ¥å£**:

```typescript
interface BookmarkItem {
  id: string; // ä¹¦ç­¾ID
  url: string; // ä¹¦ç­¾URL
  title: string; // ä¹¦ç­¾æ ‡é¢˜
  description?: string; // é¡µé¢æè¿°
  favicon?: string; // ç½‘ç«™å›¾æ ‡
  tags: string[]; // æ ‡ç­¾æ•°ç»„
  keywords: string[]; // å…³é”®è¯æ•°ç»„
  category: string; // åˆ†ç±»
  createdAt: Date; // åˆ›å»ºæ—¶é—´
  updatedAt: Date; // æ›´æ–°æ—¶é—´
  visitCount: number; // è®¿é—®æ¬¡æ•°
  lastVisited?: Date; // æœ€åè®¿é—®æ—¶é—´
  content?: string; // é¡µé¢å†…å®¹
  isImported: boolean; // æ˜¯å¦å¯¼å…¥çš„ä¹¦ç­¾
}

interface Category {
  id: string; // åˆ†ç±»ID
  name: string; // åˆ†ç±»åç§°
  icon: string; // å›¾æ ‡
  color: string; // é¢œè‰²
  parentId?: string; // çˆ¶åˆ†ç±»ID
  order: number; // æ’åº
}
```

#### `src/shared/storage/database.ts` - æ•°æ®å­˜å‚¨

**ä½œç”¨**: ä½¿ç”¨ Dexie.js é…ç½® IndexedDB æ•°æ®åº“

**æ•°æ®åº“è¡¨ç»“æ„**:

```typescript
class SmartBookmarksDB extends Dexie {
  bookmarks!: Table<BookmarkItem>; // ä¹¦ç­¾è¡¨
  categories!: Table<Category>; // åˆ†ç±»è¡¨
  searchHistory!: Table<SearchHistory>; // æœç´¢å†å²è¡¨
  settings!: Table<Settings>; // è®¾ç½®è¡¨
}
```

**é»˜è®¤æ•°æ®åˆå§‹åŒ–**:

- åˆ›å»ºé»˜è®¤åˆ†ç±»ï¼šé»˜è®¤ã€å·¥ä½œã€å­¦ä¹ ã€å¨±ä¹
- è®¾ç½®é»˜è®¤é…ç½®ï¼šå…³é”®è¯æå–å¼€å…³ã€ä¸»é¢˜è®¾ç½®ç­‰

### ğŸ–¥ï¸ ç”¨æˆ·ç•Œé¢æ¨¡å—

#### `src/popup/App.tsx` - å¼¹çª—ç•Œé¢

**ä½œç”¨**: æµè§ˆå™¨å·¥å…·æ ç‚¹å‡»åæ˜¾ç¤ºçš„å¼¹çª—ç•Œé¢

**ä¸»è¦åŠŸèƒ½**:

- ğŸ” **å¿«é€Ÿæœç´¢**: æ”¯æŒæ ‡é¢˜ã€URLã€å…³é”®è¯æœç´¢
- ğŸ“ **ä¹¦ç­¾æµè§ˆ**: æ ‘å½¢ç»“æ„å±•ç¤ºä¹¦ç­¾
- â• **æ·»åŠ ä¹¦ç­¾**: è·å–å½“å‰é¡µé¢ä¿¡æ¯å¹¶æ·»åŠ ä¹¦ç­¾
- ğŸ·ï¸ **å…³é”®è¯ç®¡ç†**: æ˜¾ç¤ºå’Œç¼–è¾‘è‡ªåŠ¨æå–çš„å…³é”®è¯

**ç•Œé¢ç‰¹ç‚¹**:

- ä½¿ç”¨ Ant Design ç»„ä»¶åº“
- å“åº”å¼è®¾è®¡ï¼Œé€‚é…ä¸åŒå±å¹•å°ºå¯¸
- æ”¯æŒé”®ç›˜å¿«æ·é”®æ“ä½œ

#### `src/main/index.tsx` - ä¸»ç•Œé¢

**ä½œç”¨**: å…¨å±ä¸»ç•Œé¢ï¼Œæä¾›å®Œæ•´çš„ä¹¦ç­¾ç®¡ç†åŠŸèƒ½

**æ ¸å¿ƒåŠŸèƒ½**:

- ğŸ“‚ **æ–‡ä»¶å¤¹ç®¡ç†**: æ”¯æŒå¤šçº§æ–‡ä»¶å¤¹ç»“æ„
- ğŸ¯ **æ‹–æ‹½æ’åº**: ä½¿ç”¨@dnd-kit å®ç°æ‹–æ‹½åŠŸèƒ½
- ğŸ” **é«˜çº§æœç´¢**: æ”¯æŒè·¨æ–‡ä»¶å¤¹æœç´¢
- ğŸ¨ **ç¾è§‚ç•Œé¢**: ä½¿ç”¨æ¸å˜èƒŒæ™¯å’Œæ¯›ç»ç’ƒæ•ˆæœ

**ç»„ä»¶ç»“æ„**:

```typescript
// å¯æ‹–æ‹½æ–‡ä»¶å¤¹å¡ç‰‡
const SortableFolderCard = ({ folder, onDelete, onFolderClick }) => {
  // æ–‡ä»¶å¤¹å±•ç¤ºå’Œæ“ä½œ
};

// å¯æ‹–æ‹½ä¹¦ç­¾å¡ç‰‡
const SortableBookmarkCard = ({ bookmark, onDelete }) => {
  // ä¹¦ç­¾å±•ç¤ºå’Œæ“ä½œ
};

// ä¸»é¡µé¢ç»„ä»¶
const MainPage = () => {
  // çŠ¶æ€ç®¡ç†å’Œä¸šåŠ¡é€»è¾‘
};
```

#### `src/options/index.tsx` - è®¾ç½®é¡µé¢

**ä½œç”¨**: æ’ä»¶è®¾ç½®é¡µé¢ï¼ˆå½“å‰ä¸ºå ä½é¡µé¢ï¼‰

**è®¡åˆ’åŠŸèƒ½**:

- âš™ï¸ å…³é”®è¯æå–è®¾ç½®
- ğŸ¨ ä¸»é¢˜é…ç½®
- âŒ¨ï¸ å¿«æ·é”®è®¾ç½®
- ğŸ”„ æ•°æ®åŒæ­¥è®¾ç½®

### ğŸ¨ æ ·å¼å’Œèµ„æº

#### `src/popup/index.css` - å¼¹çª—æ ·å¼

- è‡ªå®šä¹‰æ ·å¼è¡¥å……
- ä¸ Tailwind CSS é…åˆä½¿ç”¨

#### `tailwind.config.js` - Tailwind é…ç½®

- è‡ªå®šä¹‰ä¸»é¢˜é…ç½®
- å“åº”å¼æ–­ç‚¹è®¾ç½®

## å·¥ä½œæµç¨‹

### 1. å…³é”®è¯æå–æµç¨‹

```
ç”¨æˆ·è®¿é—®ç½‘é¡µ â†’ Content Scriptæ³¨å…¥ â†’ é¡µé¢å†…å®¹åˆ†æ â†’
nodejiebaæœç´¢å¼•æ“æ¨¡å¼åˆ†è¯ + å…³é”®è¯æå– â†’ è¯é¢‘ç»Ÿè®¡ â†’
åœç”¨è¯è¿‡æ»¤ â†’ è¿”å›6ä¸ªé«˜é¢‘æ ¸å¿ƒè¯
```

### 2. æ·»åŠ ä¹¦ç­¾æµç¨‹

```
ç”¨æˆ·ç‚¹å‡»æ·»åŠ  â†’ è·å–å½“å‰é¡µé¢ä¿¡æ¯ â†’ æå–å…³é”®è¯ â†’
æ˜¾ç¤ºè¡¨å• â†’ ç”¨æˆ·ç¡®è®¤ â†’ è°ƒç”¨Chrome API â†’ æ›´æ–°ç•Œé¢
```

### 3. æœç´¢æµç¨‹

```
ç”¨æˆ·è¾“å…¥æœç´¢è¯ â†’ è¿‡æ»¤ä¹¦ç­¾åˆ—è¡¨ â†’ é«˜äº®åŒ¹é…å†…å®¹ â†’ æ˜¾ç¤ºç»“æœ
```

## å¼€å‘æŒ‡å—

### æœ¬åœ°å¼€å‘

```bash
npm install          # å®‰è£…ä¾èµ–
npm run dev          # å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run build        # æ„å»ºç”Ÿäº§ç‰ˆæœ¬
```

### åŠ è½½åˆ°æµè§ˆå™¨

1. æ‰“å¼€ Chrome æ‰©å±•ç®¡ç†é¡µé¢
2. å¯ç”¨å¼€å‘è€…æ¨¡å¼
3. åŠ è½½`dist`æ–‡ä»¶å¤¹

## ç‰¹è‰²åŠŸèƒ½

### ğŸ§  æ™ºèƒ½å…³é”®è¯æå–

- ä½¿ç”¨ nodejieba æœç´¢å¼•æ“æ¨¡å¼åˆ†è¯ï¼Œæ›´é€‚åˆå…³é”®è¯æå–
- ç»“åˆå…³é”®è¯æå–ç®—æ³•å’Œè¯é¢‘ç»Ÿè®¡ï¼Œç¡®ä¿é«˜é¢‘æ ¸å¿ƒè¯
- ç²¾ç¡®æå– 6 ä¸ªé«˜è´¨é‡å…³é”®è¯ï¼Œé¿å…å†—ä½™
- æ”¯æŒä¸­è‹±æ–‡æ··åˆåˆ†è¯
- å¤šçº§é™çº§ç­–ç•¥ç¡®ä¿å¯ç”¨æ€§
- æ™ºèƒ½åœç”¨è¯è¿‡æ»¤

### ğŸ¯ å¤šç»´åº¦æœç´¢

- æ ‡é¢˜æœç´¢
- URL æœç´¢
- å…³é”®è¯æœç´¢
- è·¨æ–‡ä»¶å¤¹æœç´¢

### ğŸ¨ ç°ä»£åŒ– UI

- æ¯›ç»ç’ƒæ•ˆæœ
- æ¸å˜èƒŒæ™¯
- å“åº”å¼è®¾è®¡
- æµç•…åŠ¨ç”»

### âš¡ é«˜æ€§èƒ½

- IndexedDB æœ¬åœ°å­˜å‚¨
- è™šæ‹Ÿæ»šåŠ¨ä¼˜åŒ–
- æ‡’åŠ è½½æœºåˆ¶

## æ‰©å±•æ€§

é¡¹ç›®é‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼Œæ˜“äºæ‰©å±•ï¼š

- æ–°å¢å…³é”®è¯æå–ç®—æ³•
- æ·»åŠ æ–°çš„æœç´¢ç»´åº¦
- é›†æˆæ›´å¤šæ•°æ®æº
- æ”¯æŒæ›´å¤šæµè§ˆå™¨

---

_æœ€åæ›´æ–°: 2024 å¹´_
