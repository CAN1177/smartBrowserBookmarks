<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>关键词提取测试</title>
    <script src="https://unpkg.com/nodejieba@2.6.0/build/index.js"></script>
  </head>
  <body>
    <h1>关键词提取测试</h1>
    <div id="test-content">
      <h2>人工智能技术发展</h2>
      <p>
        人工智能技术正在快速发展，机器学习、深度学习、自然语言处理等技术不断突破。人工智能在医疗、教育、金融、交通等各个领域都有广泛应用。随着大数据和云计算技术的发展，人工智能的应用场景越来越丰富。
      </p>
      <p>
        深度学习是人工智能的重要分支，通过神经网络模拟人脑的学习过程。卷积神经网络在图像识别方面取得了巨大成功，循环神经网络在自然语言处理领域表现出色。Transformer架构的出现更是推动了自然语言处理技术的快速发展。
      </p>
      <p>
        人工智能的发展离不开算法、数据和算力的支撑。算法是核心，数据是基础，算力是保障。随着硬件技术的进步，GPU、TPU等专用芯片为人工智能提供了强大的计算能力。
      </p>
    </div>

    <div id="results"></div>

    <script>
      // 模拟关键词提取逻辑
      function extractKeywords(text) {
        if (!text) return [];

        try {
          // 使用 nodejieba 的搜索引擎模式分词
          if (typeof window !== "undefined" && window.nodejieba) {
            const nodejieba = window.nodejieba;

            // 使用搜索引擎模式分词，更适合关键词提取
            const searchWords = nodejieba.cutForSearch(text);

            // 使用关键词提取算法获取权重最高的词
            const extractedWords = nodejieba.extract(text, 8);

            // 结合搜索引擎分词和关键词提取的结果
            const allWords = [
              ...searchWords,
              ...extractedWords.map((item) => item.word),
            ];

            // 统计词频，优先选择高频词
            const wordCount = new Map();
            allWords.forEach((word) => {
              if (word && word.length > 1 && word.length < 15) {
                const count = wordCount.get(word) || 0;
                wordCount.set(word, count + 1);
              }
            });

            // 过滤停用词
            const stopWords = new Set([
              "的",
              "了",
              "是",
              "在",
              "有",
              "和",
              "就",
              "不",
              "人",
              "都",
              "一",
              "一个",
              "这个",
              "那个",
              "什么",
              "怎么",
              "为什么",
              "因为",
              "所以",
              "但是",
              "然后",
              "the",
              "and",
              "or",
              "but",
              "in",
              "on",
              "at",
              "to",
              "for",
              "of",
              "with",
              "by",
              "a",
              "an",
              "is",
              "are",
              "was",
              "were",
              "be",
              "been",
              "have",
              "has",
              "had",
            ]);

            // 按频率排序，返回前6个高频核心词
            const filteredWords = Array.from(wordCount.entries())
              .filter(([word]) => !stopWords.has(word))
              .sort((a, b) => b[1] - a[1])
              .slice(0, 6)
              .map(([word]) => word);

            console.log("nodejieba 提取的关键词:", filteredWords);
            return filteredWords;
          }
        } catch (error) {
          console.log("nodejieba 不可用，使用备用方案:", error);
        }

        // 备用方案
        const cleanText = text
          .replace(/<[^>]*>/g, " ")
          .replace(/[^\u4e00-\u9fa5a-zA-Z0-9\s]/g, " ")
          .toLowerCase();

        const chineseWords = cleanText.match(/[\u4e00-\u9fa5]{2,}/g) || [];
        const englishWords = cleanText.match(/[a-zA-Z]{3,}/g) || [];

        const allWords = [...chineseWords, ...englishWords].filter(
          (word) => word.length > 1 && word.length < 15
        );

        const stopWords = new Set([
          "的",
          "了",
          "是",
          "在",
          "有",
          "和",
          "就",
          "不",
          "人",
          "都",
          "一",
          "一个",
          "这个",
          "那个",
          "什么",
          "怎么",
          "为什么",
          "因为",
          "所以",
          "但是",
          "然后",
          "the",
          "and",
          "or",
          "but",
          "in",
          "on",
          "at",
          "to",
          "for",
          "of",
          "with",
          "by",
          "a",
          "an",
          "is",
          "are",
          "was",
          "were",
          "be",
          "been",
          "have",
          "has",
          "had",
        ]);

        const wordCount = new Map();

        allWords.forEach((word) => {
          if (!stopWords.has(word)) {
            const count = wordCount.get(word) || 0;
            wordCount.set(word, count + 1);
          }
        });

        const result = Array.from(wordCount.entries())
          .sort((a, b) => b[1] - a[1])
          .slice(0, 6)
          .map(([word]) => word);

        console.log("备用方案提取的关键词:", result);
        return result;
      }

      // 测试关键词提取
      function testKeywordExtraction() {
        const testText = document.getElementById("test-content").innerText;
        const keywords = extractKeywords(testText);

        const resultsDiv = document.getElementById("results");
        resultsDiv.innerHTML = `
                <h3>提取结果：</h3>
                <p><strong>关键词数量：</strong>${keywords.length}</p>
                <p><strong>关键词列表：</strong></p>
                <ul>
                    ${keywords.map((keyword) => `<li>${keyword}</li>`).join("")}
                </ul>
                <h3>原始文本：</h3>
                <p style="background: #f5f5f5; padding: 10px; border-radius: 5px;">${testText}</p>
            `;
      }

      // 页面加载完成后执行测试
      window.addEventListener("load", () => {
        setTimeout(testKeywordExtraction, 1000); // 等待nodejieba加载
      });
    </script>
  </body>
</html>
